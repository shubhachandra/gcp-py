Comprehensive Worker Node and Network Recommendations

Combined Tee-Size Reference Table:

Tee-Size

Data Size (TB)

Concurrent Jobs

Worker Nodes

Autoscaling

GKE Nodes

Pods

Services

DAGs

Dataflow Workers

Dataproc Workers

Subnet CIDR (Primary)

Pod Range (Secondary)

Services Range (Secondary)

Extra Small

< 0.5

1-2

2-4

Low

2-4

5-8

2-4

2-4 DAGs

2-4

2-4

/28 (14 IPs)

/26 (62 IPs)

/28 (14 IPs)

Small

0.5 - 2

2-5

4-6

Medium

3-6

6-10

5-8

4-8 DAGs

4-8

4-8

/27 (30 IPs)

/25 (126 IPs)

/26 (62 IPs)

Medium

2 - 10

2-5

7-12

High

4-8

10-15

8-12

8-12 DAGs

8-12

8-12

/26 (62 IPs)

/22 (1022 IPs)

/24 (254 IPs)

Large

10 - 50

6-10

13-20

High

8-10

15-20

12-16

12-16 DAGs

15-20

15-20

/25 (126 IPs)

/21 (2046 IPs)

/24 (254 IPs)

Extra Large

50+

11+

21+

Very High

10+

20+

15+

15+ DAGs

20+

20+

/24 or larger

/20 (4094 IPs)

/23 (510 IPs)

How Dataflow and Dataproc Manage Worker Nodes:

Dataflow:

Dynamically manages nodes via auto-scaling based on real-time workload demands.

Automatically scales up or down worker nodes.

Dataproc:

Uses YARN-based autoscaling to dynamically add or remove nodes according to predefined thresholds and workload.

Automatically provisions or removes worker nodes as required.

Composer 2 vs Composer 3 Resource Comparison:

Composer Version

GKE Nodes (Typical)

Pods per DAG Execution

DAG Count

Autoscaling Efficiency

Composer 2

3-8 Nodes

5-12 Pods

5-12 DAGs

Good

Composer 3

8-20 Nodes

12-20 Pods

10-20+ DAGs

Excellent

Recommended Network Ranges:

Primary CIDR Range:

/23 subnet (512 IP addresses) or larger for general Composer resource provisioning (nodes, workers, services).

Secondary CIDR Ranges:

Pods: /21 (2046 IP addresses)

Services: /24 (254 IP addresses)

Best Practices:

Continuously monitor node usage, workload patterns, and autoscaling efficiency.

Adjust CIDR ranges proactively to avoid IP address exhaustion.

Apply consistent Composer tags for effective resource tracking, auditing, and cost management.
